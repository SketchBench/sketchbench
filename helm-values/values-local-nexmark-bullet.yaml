### Benchmark Control Plane ###

dataIngestion:
  nexmark:
    enabled: true


  nexmark:
    enabled: false
    jar: /NEXMarkStream/NEXMarkStream-jar-with-dependencies.jar
    javaOpts: -Xms1g
    runClass: edu.illinois.sketchbench.datagen.JSONAuctionStreamGenerator
    kafkaBootServers: kafka:9092
    kafkaTopic: SketchBench-nexmark
    threadSleep: 1
    replicaCount: 1
    image:
      repository: sketchbench/sketchbench-data-ingestion-nexmark
      pullPolicy: IfNotPresent
      tag: "0.1.2"
    podAnnotations: {}
    podSecurityContext: {}
    securityContext: {}
    resources: {}
    nodeSelector: {}
    tolerations: []
    affinity: {}



bullet:
  enabled: true
  spark: # System Under Test
    enabled: true
    image:
      repository: sketchbench/bullet-spark-3.0
      tag: "1.0.4"
      pullPolicy: IfNotPresent
    worker:
      replicaCount: 2
      coreLimit: 3
      resources:
        requests:
          memory: "4Gi"
          cpu: "3.5"
        limits:
          memory: "4Gi"
          cpu: "3.5"
    master:
      resources:
        requests:
          memory: "4Gi"
          cpu: "1"
        limits:
          memory: "4Gi"
          cpu: "1"
    podAntiAffinitypreset: hard
    metrics:
      enabled: true
      podMonitor:
        enabled: true
  pubsub:
    metrics:
      kafka:
        enabled: true
      jmx:
        enabled: true
      serviceMonitor:
        enabled: true
    zookeeper:
      metrics:
        enabled: true
        serviceMonitor:
          enabled: true
  sparkBackend:
    executorCores: 2
    executorMemory: 3G
    resources:
      requests:
        memory: "4Gi"
        cpu: "1"
      limits:
        memory: "4Gi"
        cpu: "1"
    image:
      repository: sketchbench/bullet-spark-3.0
    hdfsUser: hadoop
    hdfs:
      port: 8020
    metrics:
      enabled: true
      podMonitor:
        enabled: true
    config:
      bullet:
        spark:
          dsl:
            data:
              producer:
                enable: true
            deserializer:
              enable: false
        dsl:
          connector:
            class:
              name: com.yahoo.bullet.dsl.connector.KafkaConnector
            kafka:
              topics:
                - SketchBench-1-1
              bootstrap:
                servers:
                  - kafka:9092
          converter:
            class:
              name: com.yahoo.bullet.dsl.converter.JSONBulletRecordConverter
            schema:
              type:
                check:
                  enable: false
          deserializer:
            class:
              name: com.yahoo.bullet.dsl.deserializer.IdentityDeserializer
    dsl:
      schema: |
        {
          "fields": [
            {
              "name": "messageID",
              "type": "INTEGER"
            },
            {
              "name": "ts",
              "type": "STRING"
            },
            {
              "name": "index",
              "type": "LONG"
            },
            {
              "name": "mf01",
              "type": "INTEGER"
            },
            {
              "name": "mf02",
              "type": "INTEGER"
            },
            {
              "name": "mf03",
              "type": "INTEGER"
            },
            {
              "name": "pc13",
              "type": "INTEGER"
            },
            {
              "name": "pc14",
              "type": "INTEGER"
            },
            {
              "name": "pc15",
              "type": "INTEGER"
            },
            {
              "name": "pc25",
              "type": "INTEGER"
            },
            {
              "name": "pc26",
              "type": "INTEGER"
            },
            {
              "name": "pc27",
              "type": "INTEGER"
            },
            {
              "name": "res",
              "type": "INTEGER"
            }
          ]
        }

zeppelin:
  enabled: true
  runMode: local
  interpreters:
    - file
    - md
    - python
    - sh
  metrics:
    enabled: true
    podMonitor:
      enabled: true

### Data Ingestion (isolated Kafka cluster) ###

kafka:
  podAntiAffinitypreset: hard
  logRetentionHours: 6
  numPartitions: 7
  resources:
    requests:
      memory: "2Gi"
      cpu: "1"
    limits:
      memory: "2Gi"
      cpu: "1"
  metrics:
    kafka:
      enabled: true
    jmx:
      enabled: true
    serviceMonitor:
      enabled: true
  zookeeper:
    metrics:
      enabled: true
      serviceMonitor:
        enabled: true

### Benchmark Observability Stack ###

kafdrop:
  enabled: true

tobs:
  enabled: true
  kube-prometheus-stack:
    alertmanager:
      enabled: false # not needed
    prometheus:
      prometheusSpec:
        podMonitorSelectorNilUsesHelmValues: false
        serviceMonitorSelectorNilUsesHelmValues: false
